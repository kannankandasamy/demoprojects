/*
 * Script 	:	POC for General topics on snowflake
 * Author	:	Kannan Kandasamy
 */

USE DATABASE TEST;
--USE WAREHOUSE compute_wh;
USE SCHEMA SAMPLES;
USE ROLE AccountAdmin; -- or security admin

SELECT top 10 * FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER;

CREATE  SCHEMA SAMPLES;

USE SCHEMA samples;

SELECT count(*) FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF10.CUSTOMER;

SELECT  current_schema();

--CREATE TABLE CUSTOMER AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER;

TRUNCATE TABLE customer;

INSERT INTO customer SELECT * FROM  SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER;

CREATE TABLE CUSTOMER_BKP CLONE customer;

SELECT * FROM INFORMATION_SCHEMA.TABLE_STORAGE_METRICS;

SELECT top 10 * FROM orders;

CREATE TABLE orders AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS;

TRUNCATE TABLE orders;

INSERT INTO orders SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS;

SELECT SYSTEM$CLUSTERING_INFORMATION('ORDERS', '(O_ORDERKEY, O_CUSTKEY)');

SELECT SYSTEM$CLUSTERING_DEPTH('ORDERS','(O_CUSTKEY)');


CREATE TABLE NATION AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.NATION;

CREATE TRANSIENT TABLE SUPPLIER AS SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER;

SELECT top 10 * FROM orders;

INSERT INTO test.samples.LINEITEM  SELECT * FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM;

TRUNCATE TABLE test.samples.LINEITEM;

SELECT count(*) FROM orders WHERE o_custkey IN (SELECT c_custkey FROM customer WHERE c_nationkey >= 10);

ALTER SESSION SET USE_CACHED_RESULT = TRUE;


CREATE OR REPLACE SCHEMA EXAMPLES;

USE SCHEMA samples;


